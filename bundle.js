(()=>{"use strict";var t={50:function(t,e,r){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=i(r(463)),o=function(){function t(t,e){void 0===e&&(e=""),this._elem=t,this._cursor=[0,0,0],this._elem.addEventListener("keydown",this.onkeydown.bind(this)),this._elem.addEventListener("paste",this.onpaste.bind(this)),this._rope=s.default.leaf(e),this.render()}return t.prototype.onkeydown=function(t){var e,r;if("v"!==t.key||!t.ctrlKey&&!t.metaKey)switch(1===t.key.length&&(this._rope.insert(this._rope.lineToChar(this._cursor[2])+this._cursor[0],t.key),this._cursor[0]+=1,this._cursor[1]=this._cursor[0],this.render()),t.key){case"ArrowLeft":this._cursor[0]>0?(this._cursor[0]-=1,this._cursor[1]=this._cursor[0],this.render()):this._cursor[1]=this._cursor[0];break;case"ArrowRight":this._cursor[0]<this._rope.lines()[this._cursor[2]].length?(this._cursor[0]+=1,this._cursor[1]=this._cursor[0],this.render()):this._cursor[1]=this._cursor[0];break;case"ArrowUp":this._cursor[2]>0&&(this._cursor[2]-=1,this._cursor[0]=Math.min(this._cursor[1],this._rope.lines()[this._cursor[2]].length),this.render());break;case"ArrowDown":this._cursor[2]<this._rope.lines().length-1&&(this._cursor[2]+=1,this._cursor[0]=Math.min(this._cursor[1],null===(e=this._rope.lines()[this._cursor[2]])||void 0===e?void 0:e.length),this.render());break;case"Backspace":if(this._rope.lineToChar(this._cursor[2])+this._cursor[0]>0){var i=null===(r=this._rope.lines()[this._cursor[2]-1])||void 0===r?void 0:r.length;this._rope.remove(this._rope.lineToChar(this._cursor[2])+this._cursor[0]-1),this._cursor[0]>0?this._cursor[1]=this._cursor[0]-=1:this._cursor[2]>0&&(this._cursor[2]-=1,this._cursor[1]=this._cursor[0]=i),this.render()}break;case"Enter":this._rope.insert(this._rope.lineToChar(this._cursor[2])+this._cursor[0],"\n"),this._cursor[1]=this._cursor[0]=0,this._cursor[2]+=1,this.render()}},t.prototype.onpaste=function(t){if(t.clipboardData){var e=this._rope.lineToChar(this._cursor[2])+this._cursor[0],r=t.clipboardData.getData("text");this._rope.insert(e,r),this._cursor[2]=this._rope.charToLine(e+r.length),this._cursor[0]=this._cursor[1]=e+r.length-this._rope.lineToChar(this._cursor[2]),this.render()}},t.prototype.render=function(){for(var t=this;this._elem.firstChild;)this._elem.removeChild(this._elem.firstChild);this._rope.lines().forEach((function(e,r){var i=document.createElement("div");if(r===t._cursor[2]){var s=document.createElement("span"),o=document.createElement("span"),n=document.createElement("span");s.textContent=e.slice(0,t._cursor[1]),o.textContent=e[t._cursor[1]]||" ",o.classList.add("cursor"),n.textContent=e.slice(t._cursor[1]+1),i.appendChild(s),i.appendChild(o),i.appendChild(n)}else i.textContent=e;t._elem.appendChild(i)}))},t}();e.default=o},463:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._node=t}return t.leaf=function(e){return void 0===e&&(e=""),new t({kind:"leaf",text:e})},t.branch=function(e,r){return new t({kind:"branch",left:e,right:r})},Object.defineProperty(t.prototype,"length",{get:function(){var t,e;switch(this._node.kind){case"branch":return((null===(t=this._node.left)||void 0===t?void 0:t.length)||0)+((null===(e=this._node.right)||void 0===e?void 0:e.length)||0);case"leaf":return this._node.text.length}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){var t;switch(this._node.kind){case"branch":return(null===(t=this._node.left)||void 0===t?void 0:t.length)||0;case"leaf":return this._node.text.length}},enumerable:!1,configurable:!0}),t.prototype.index=function(t){switch(this._node.kind){case"branch":if(this.weight<=t&&this._node.right)return this._node.right.index(t-this.weight);if(this._node.left)return this._node.left.index(t);throw"unreachable: neither left/right of _node is defined";case"leaf":return this._node.text[t]}},t.prototype.insert=function(e,r){var i=this.split(e);this.concat(t.leaf(r)),this.concat(i)},t.prototype.remove=function(t,e){void 0===e&&(e=1);var r=this.split(t).split(e);this.concat(r)},t.prototype.split=function(e){switch(this._node.kind){case"branch":if(this.weight<=e&&this._node.right)return this._node.right.split(e-this.weight);if(this._node.left){var r=this._node.left.split(e);return this._node.right&&r.concat(this._node.right),this._node.right=null,r}throw"unreachable: neither left/right of _node is defined";case"leaf":return r=t.leaf(this._node.text.slice(e)),this._node.text=this._node.text.slice(0,e),r}},t.prototype.concat=function(e){var r=this._node;this._node={kind:"branch",left:new t(r),right:e}},t.prototype.charToLine=function(t){for(var e=this.toString(),r=0;;r++){var i=e.indexOf("\n")+1;if(0===i){if(t<=e.length)return r;throw new Error("char ${char} out of bounds")}if(t<i)return r;t-=i,e=e.slice(i)}},t.prototype.lineToChar=function(t){for(var e=this.toString(),r=0,i=0;i!==t;i++){var s=e.indexOf("\n")+1;if(0===s)throw new Error("line "+t+" is out of bounds");r+=s,e=e.slice(s)}return r},t.prototype.toString=function(){var t,e;switch(this._node.kind){case"branch":return((null===(t=this._node.left)||void 0===t?void 0:t.toString())||"")+((null===(e=this._node.right)||void 0===e?void 0:e.toString())||"");case"leaf":return this._node.text}},t.prototype.lines=function(){return this.toString().split(/\r?\n/)},t}();e.default=r},532:function(t,e,r){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Editor=void 0;var s=r(50);Object.defineProperty(e,"Editor",{enumerable:!0,get:function(){return i(s).default}})}},e={};new(function r(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,r),o.exports}(532).Editor)(document.getElementById("editor"))})();